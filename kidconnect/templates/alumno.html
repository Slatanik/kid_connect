{% extends 'layout.html' %}
{% load static %}
{% block content %}

<body>
    <div class="d-flex" id="content-wrapper">
        <!-- Sidebar -->
        <div id="sidebar-container" class="bg-primary">
            <div class="logo">
                <h4 class="text-light font-weight-bold mb-0">Kids connect</h4>
            </div>
            <div class="menu">
              <a href="{% url 'evento' %}" class="d-block text-light p-3 border-0"><i class="icon ion-md-apps lead mr-2"></i>
                  Calendario</a>
              <a href="{% url 'docente' %}" class="d-block text-light p-3 border-0"><i class="icon ion-md-people lead mr-2"></i>
                  Profesores</a>          
              <a href="{% url 'alumno' %}" class="d-block text-light p-3 border-0"><i class="icon ion-md-book outline mr-2"></i>
                  Estudiante</a>
              <a href= "{% url 'correo' %}" class="d-block text-light p-3 border-0"><i class="icon ion-md-mail-unread mr-2"></i>
                  Mensajes</a>
          </div>
        </div>
        <!-- Fin sidebar -->

        <div class="w-100">

         <!-- Navbar -->
         <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
            <div class="container">
    
              <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
    
              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <form class="form-inline position-relative d-inline-block my-2">
                  <input class="form-control" type="search" placeholder="Buscar por Rut" aria-label="Buscar">
                  <button class="btn position-absolute btn-search" type="submit"><i class="icon ion-md-search"></i></button>
                </form>
                <ul class="navbar-nav ml-auto mt-2 mt-lg-0">
                  <li class="nav-item dropdown">
                    <a class="nav-link text-dark dropdown-toggle" href="#" id="navbarDropdown" role="button"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">                     
                    Estimado <span id="storedValue"></span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                      <a class="dropdown-item" href="index">Cerrar sesión</a>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
          <!-- Fin Navbar -->

        <!-- Page Content -->
        <div id="content" class="bg-grey w-100">

              <section class="bg-light py-3">
                  <div class="container">
                      <div class="row">
                          <div class="col-lg-9 col-md-8">
                            <h1 class="font-weight-bold mb-0">Información Alumo</h1>
                            <p class="lead text-muted">Revisa la última información</p>
                          </div>                         
                  <div class="container">
                      <div class="row">
                          <div class="col-lg-8 my-3">
                              <div class="card rounded-0">
                                  <div class="card-header bg-light">
                                    <h6 class="font-weight-bold mb-0">Ficha Alumno
                                      <form class="form-inline position-relative d-inline-block my-2">
                                        <input class="form-control" type="search" placeholder="Buscar por Rut" aria-label="Buscar" id="rutBusqueda">
                                        <button class="btn position-absolute btn-search" id='Buscar' type="submit"><i class="icon ion-md-search"></i></button>
                                      </form>

                                    </h6>
                                  </div> 
                                  <div>
                                    
                              </head>
                            
                                  </div>
                                  
                                  <div>
                                    <div id="rutDiv">
                                      <label>Rut Alumno:</label>
                                      <span id="rut_alumno" value=""></span>
                                    </div>
                                    
                                    <div id="fechaDiv">
                                      <label>Fecha:</label>
                                      <span id="fecha" value=""></span>
                                    
                                    <div id="contenidoDiv">
                                      <label>Contenido:</label>
                                      <sapn id="contenido"></sapn>
                                    </div>
                                    
                                    <script>
                                      const form = document.getElementById('Buscar');
                                      form.addEventListener('click', function(event) {
                                        event.preventDefault(); // Evita la recarga de la página
                                        const rut = document.getElementById('rutBusqueda');
                                              fetch(`http://tmp.enred.cl/kc/rest/get_ficha_id.php?nombreFuncion=buscarFichaPorRut&rut_alumno=${rut.value}`, {
                                                method: 'GET',
                                              })
                                                .then(response => {
                                                  if (!response.ok) {
                                                    throw new Error('Error al enviar la solicitud');
                                                  }
                                                  return response.json();
                                                })
                                                .then(data => {
                                                  const nombreAlumno = document.getElementById('rut_alumno');
                                                  const fecha = document.getElementById('fecha');
                                                  const contenido = document.getElementById('contenido');
                                                  nombreAlumno.textContent = data.data.alumno_rut_alu
                                                  fecha.textContent = data.data.fec_cre
                                                  contenido.textContent = data.data.con_fc
                                                })
                                                .catch(error => {
                                                  console.error(error);
                                                });
                                            });
                                    </script>

                                    {% comment %} {% for i in datos %}
                                    <div>
                                        <ul>
                                          <li>Rut Alumno: {{ i.alumno_numrun_alu }}</li> 
                                          <li>Codigo: {{ i.id_fch }}</li> 
                                          <li> Fecha Creacion:{{i.per_fch}}</li>
                                          <li>Contenido: {{i.des_fch}}</li>
                                        </ul>
                                      </div>
                                      <hr>
                                    {% endfor %} {% endcomment %}



                                    <div><button id="toggle-btn">Actualizar ficha Alumno</button><div>

                                    <form id="miFormulario">
                                        <label for="nom_alu">Nombre alumno:</label>
                                        <input type="text" id="nom_alu" name="nom_alu">
                                        <label for="ap_pat_alu">Apellido Paterno:</label>
                                        <input type="text" id="ap_pat_alu" name="ap_pat_alu">
                                        
                                        <div><input type="submit" value="Enviar"><div>
                                    </form>
                                
                                    <!--<script>
                                        // Obtener referencia al botón y al formulario
                                        var toggleBtn = document.getElementById('toggle-btn');
                                        var formulario = document.getElementById('miFormulario');
                                
                                        // Agregar un controlador de eventos para alternar la visibilidad del formulario al hacer clic en el botón
                                        toggleBtn.addEventListener('click', function() {
                                            if (formulario.style.display === 'none') {
                                                formulario.style.display = 'block';
                                            } else {
                                                formulario.style.display = 'none';
                                            }
                                        });
                                    </>-->    
                                  </div>                              
                                  <script>
                                    const form = document.getElementById('miFormulario');
                                    form.addEventListener('submit', function(event) {
                                      event.preventDefault(); // Evita que la página se recargue al enviar el formulario
                                      
                                      const datos = new FormData(form); // Obtiene los datos del formulario
                              
                                      fetch('http://tmp.enred.cl/kc/rest/post_ficha.php', {
                                        method: 'POST',
                                        body: {}
                                      })
                                      .then(response => {
                                        if (!response.ok) {
                                          throw new Error('Error al enviar la solicitud');
                                        }
                                        return response.json();
                                      })
                                      .then(data => {
                                        console.log('El registro ha sido creado:', data);
                                      })
                                      .catch(error => {
                                        console.error(error);
                                      });
                                    });
                                  </script>
                            
                          </div>
                          <div class="col-lg-4 my-3">
                            <div class="card rounded-0">
                                <div class="card-header bg-light">
                                    <h6 class="font-weight-bold mb-0">TRABAJOS </h6>
                                </div>
                                <div class="card-body pt-2">
                                    <div class="d-flex border-bottom py-2">
                                        <div class="d-flex mr-3">
                                          <h2 class="align-self-center mb-0"><i class="icon ion-md-pricetag"></i></h2>
                                        </div>
                                        <div class="align-self-center">
                                          <h6 class="d-inline-block mb-0">CURSO 1 </h6><span class="badge badge-success ml-2">TODO OK </span>
                                          <small class="d-block text-muted">TRABAJO DE ARTES</small>
                                        </div>
                                    </div>
                                    <div class="d-flex border-bottom py-2">
                                        <div class="d-flex mr-3">
                                          <h2 class="align-self-center mb-0"><i class="icon logo-ionic"></i></h2>
                                        </div>
                                        <div class="align-self-center">
                                          <h6 class="d-inline-block mb-0">CURSO 2</h6><span class="badge badge-success ml-2">FALTO PEPITO</span>
                                          <small class="d-block text-muted">Curso BAILE</small>
                                        </div>
                                    </div>
                                    <button class="btn btn-primary w-100">Ver todas</button>
                                </div>
                            </div>
                          </div>
                      </div>
                  </div>
              </section>

        </div>

        </div>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js" integrity="sha256-R4pqcOYV8lt7snxMQO/HSbVCFRPMdrhAFMH+vr9giYI=" crossorigin="anonymous"></script>
        <script>
            var ctx = document.getElementById('myChart').getContext('2d');
            var myChart = new Chart(ctx, { 
                type: 'bar',
                data: {
                    labels: ['Feb 2020', 'Mar 2020', 'Abr 2020', 'May 2020'],
                    datasets: [{
                        label: 'Nuevos usuarios',
                        data: [50, 100, 150, 200],
                        backgroundColor: [
                            '#12C9E5',  
                            '#12C9E5',
                            '#12C9E5',
                            '#111B54'
                        ],
                        maxBarThickness: 30,
                        maxBarLength: 2
                    }]
                },
                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });
            </script>
</body>


{% endblock %}